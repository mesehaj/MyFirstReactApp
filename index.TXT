this is version 3 of code